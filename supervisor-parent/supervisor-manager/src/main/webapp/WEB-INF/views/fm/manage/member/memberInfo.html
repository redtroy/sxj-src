 <td colspan="11">
 <script>
 $(function () {
     $("#uploadify_${member.id}").uploadify({
         //指定swf文件
         swf: '${basePath}upload/uploadify.swf',
         //后台处理的页面
         uploader: '${basePath}upload.htm',
         //按钮显示的文字
         buttonText: '上传图片',
         //显示的高度和宽度，默认 height 30；width 120
         //'height': 15,
         //'width': 80,
         //上传文件的类型  默认为所有文件    'All Files'  ;  '*.*'
         //在浏览窗口底部的文件类型下拉菜单中显示的文本
         fileTypeDesc: 'Image Files',
         //允许上传的文件后缀
         fileTypeExts: '*.jpg;',
         //发送给后台的其他参数通过formData指定
         //'formData': { 'someKey': 'someValue', 'someOtherKey': 1 },
         //上传文件页面中，你想要用来作为文件队列的元素的id, 默认为false  自动生成,  不带#
         //'queueID': 'fileQueue',
         //选择文件后自动上传
         auto: true,
         //设置为true将允许多文件上传
         multi: true,
 		onUploadSuccess : function(file, data, response) {
			var num = 1;
			var dataObj = eval("(" + data + ")");//转换为json对象 
				alert(dataObj.fileIds);
			}
     });
 });
 var filterArr=function(arr,value){
	 alert(arr.length);
		for(var i=0;i<arr.length;i++){
			if(arr[i]==value)
				return i;
		}
	};
	
	var replace=function(attr,idx,value){
		attr[idx]=value;
	};
	
	var push=function(arr,value){
		var i=filterArr(arr,value);
		if(i)
			replace(arr,i,value);
		else
			replace(arr,0,value);
	};
	
	Date.prototype.Format = function (fmt) { //author: meizz 
	    var o = {
	        "M+": this.getMonth() + 1, //月份 
	        "d+": this.getDate(), //日 
	        "h+": this.getHours(), //小时 
	        "m+": this.getMinutes(), //分 
	        "s+": this.getSeconds(), //秒 
	        "q+": Math.floor((this.getMonth() + 3) / 3), //季度 
	        "S": this.getMilliseconds() //毫秒 
	    };
	    if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
	    for (var k in o)
	    if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
	    return fmt;
	}
		var getImage = function(imageVal) {
			$.post("getMemberImage.htm", {
				"imageId" : imageVal
			}, function(data) {
				$("#id").val(data.model.memberImage.id);
				$("#image").val(data.model.memberImage.image);
				$("#certificateType").val(
						data.model.memberImage.certificateType);
				$("#certificateNo").val(data.model.memberImage.certificateNo);
				$("#issueDate").val(
						new Date(data.model.memberImage.issueDate)
								.Format("yyyy-MM-dd"));
				$("#dueDate").val(new Date(data.model.memberImage.dueDate)
				.Format("yyyy-MM-dd"));
				$("#remark").val(data.model.memberImage.remark);
			});
		}
		$("#submitComponent").click(
				function() {
					$.post("addMemberImage.htm", $("#form").serialize(),
							function(data) {
								if (data.isok == 'ok') {
									alert("成功");
								} else {
									alert("失败");
								}
							});
				});

		$(document).ready(
				function() {
					var indexArr = new Array();
					var dataArr = new Array();
					var currentSlide;
					var offsetTop = $(window).scrollTop() + "px";
					//alert(offsetTop)
					$(window).scroll(function() {
						offsetTop = $(window).scrollTop() + "px";
						$("#imagecomponent").css({
							top : offsetTop
						});
					});
					var iv = $("#viewer").iviewer();
					/**弹出层滚动条
					滚动式更新iviewer
					 **/
					var hSlide = new $.slide({
						container : "#hidden",
						imageWidth : 90,
						imagesPerPage : 8,
						onSlide : function(li, index) {
							iv.iviewer('loadImage', li.find("img").attr("data"));
							var data = li.find("img").attr("data");
							var imageVal = data.replace("${b.imagePath}", "");
							getImage(imageVal);
						},
						onClick : function(self, li, index, i) {
							var data = $(self.getImageLis()).find("li").eq(
									index).find("img").attr("data");
							var imageVal = data.replace("${b.imagePath}", "");
							getImage(imageVal);
						}

					});
					/**原图片滚动条
					点击后显示控件层
					 **/
					var oSlide = new $.slide({
						container : "#original",
						imageWidth : 90,
						imagesPerPage : 5,
						onClick : function(self, li, index, i) {
							var data = $(self.getImageLis()).find("li").eq(
									index).find("img").attr("data");
							var imageVal = data.replace("${b.imagePath}", "");
							getImage(imageVal);
							self.copyTo($("#hidden .line-con"));
							$(".maskdivgen").fadeIn(100);
							$("#imagecomponent").css({
								top : offsetTop
							});
							$("#imagecomponent").css("visibility", "visible");
							hSlide.reset(0, 1);
							hSlide.slideTo(index);
							iv.iviewer('destroy');
							iv = $("#viewer").iviewer();
							iv
									.iviewer('loadImage', li.find("img").attr(
											"data"));
							currentSlide = self;
						},
						onSlide : function() {
							$("#form")[0].reset();
						}
					});
					var oSlide2 = new $.slide({
						container : "#original2",
						imageWidth : 90,
						imagesPerPage : 5,
						onClick : function(self, li, index, i) {
							var data = $(self.getImageLis()).find("li").eq(
									index).find("img").attr("data");
							var imageVal = data.replace("${b.imagePath}", "");
							getImage(imageVal);
							self.copyTo($("#hidden .line-con"));
							$(".maskdivgen").fadeIn(100);
							$("#imagecomponent").css({
								top : offsetTop
							});
							$("#imagecomponent").css("visibility", "visible");
							hSlide.reset(0, 1);
							hSlide.slideTo(index);
							iv.iviewer('destroy');
							iv = $("#viewer").iviewer();
							iv
									.iviewer('loadImage', li.find("img").attr(
											"data"));
							currentSlide = self;
						},
						onSlide : function() {
							$("#form")[0].reset();
						}
					});
					/**
					iviewer上左右按钮
					 **/
					$("#next,#front").hover(function() {
						$(this).children("a").fadeIn();
					}, function() {
						$(this).children("a").fadeOut();
					});
					/**
					同步删除两个图片滚动层
					 **/
					$(".iviewer_del").live("click", function() {
						var i = hSlide.deleteImage(hSlide.getIndex());
						iv.iviewer('loadImage', hSlide.getCurrentImageData());
						currentSlide.deleteImage(i <= 0 ? 0 : i + 1);
						currentSlide.slideTo(hSlide.getIndex());
						if (!hSlide.getCurrentImageData())
							iv.children("img").attr("src", "");

					});
					$("#next").click(function() {
						hSlide.slideNext();
						currentSlide.slideNext();
						iv.iviewer('loadImage', hSlide.getCurrentImageData());
						var data = hSlide.getImageData(hSlide.getIndex());
						var imageVal = data.replace("${b.imagePath}", "");
						getImage(imageVal);
					});
					$("#front").click(function() {
						hSlide.slideFront();
						currentSlide.slideNext();
						iv.iviewer('loadImage', hSlide.getCurrentImageData());
						var data = hSlide.getImageData(hSlide.getIndex());
						var imageVal = data.replace("${b.imagePath}", "");
						getImage(imageVal);
					});
					$("#btnClsVie").click(function() {
						$("#form")[0].reset();
						$('.maskdivgen').fadeOut(100);
						$("#imagecomponent").css("visibility", "hidden");
					})
				});
	</script>
 		  <div class="infoBox" id="basic-message"> 
 		  <form action="javascirpt:void(0)" id="${member.id}_info_form" class="needValid">
 			<input type="hidden" name ="id" value="${member.id}"/> 
		        <div id="block-name">基本信息</div>
          <div class="left-news">
          <ul class="ly-clearFix">
          <li style="width:99%"><label class="lable">会员名称</label>${member.name}</li>
          <li style="width:99%">
            <label class="lable">会员类型</label>
           <#if (member.checkState.getId() != 2)>
            <select name="type">
              <#list types as type>
                <#if (type.getId()==member.type.getId())>
                      <option value="${type.getId()}" selected="selected">${type.getName()}</option>
                <#else>
                      <option value="${type.getId()}">${type.getName()}</option>
                </#if>
            </#list>
            </select>
            <#else>
               &nbsp; ${member.type.getName()}<input type="hidden" name="type" value="${member.type.getId()}" />
            </#if>
          </li>
          <li style="width:99%"><label class="lable">城市</label> 江苏省-
                      <select name="area" id="city">
           	<option value="">-请选择-</option>
          	<#list cityList as city>
          	<#if (("32:江苏省,"+city.id+":"+city.name)==member.area)>
          	 <option value="32:江苏省,${city.id}:${city.name}" selected="selected">${city.name}</option>
          	<#else>
            <option value="32:江苏省,${city.id}:${city.name}">${city.name}</option>
            </#if>
            </#list>
          </select></li>
          <li style=" width:99%"><label class="lable">联系人名称</label><input type="text" value="${member.getContacts()}" datatype="*2-25" nullmsg="联系人不能为空" name="contacts"/></li>
          <li style=" width:99%"><label class="lable">联系人手机</label><input type="text" value="${member.phoneNo}" datatype="m" nullmsg="手机号码不能为空" name="phoneNo"/></li>
          <li style=" width:99%"><label class="lable">公司地址</label><input type="text" value="${member.address}" datatype="*2-50" nullmsg="地址不能为空" name="address"/></li>
          <li style=" width:99%"><label class="lable">固定电话</label><input type="text" value="${member.telNum}" name="telNum"/></li>
          <li style=" width:99%"><label class="lable">注册时间</label><#if (member.regDate??)>${member.regDate?string("yyyy-MM-dd HH:mm:ss")} </#if></li>
          <li style=" width:99%"><label class="lable">认证时间</label><#if (member.authorDate??)> ${member.authorDate?string("yyyy-MM-dd HH:mm:ss")} </#if></li>

          <li style=" width:99%"><label class="lable">子帐号数</label>${member.getAccountNum()}个</li>
           <li style=" width:99%"><label class="lable">法人代表</label><input type="text" value="${member.legalRep}" id="legalRep" name="legalRep" /></li>
          <li style=" width:99%"><label class="lable">注册资本</label><input type="text" value="${member.registeredCapital}" id="registeredCapital" datatype="n1-10" name="registeredCapital" />万元</li>
          <li style=" width:99%;height: 70px;"><label class="lable">备注</label><textarea style="width:38%" rows="2" cols="0" name="remark">${member.remark}</textarea></li>
          </ul>
          </div>
			<div class="right-news">
				<ul class="ly-clearFix">
					<li style="width: 99%"></li>
					<li style="width: 99%" class="view"><label class="lable">营业执照</label><input
						type="text" name="bLicenseNo" value="${member.getbLicenseNo()}" />
						<a href="javascript:void(0);"
						class="lnk-blue lnk-underline demo-image"
						image="${member.bLicensePath}"
						data-image="${b.imagePath}${member.bLicensePath}">查看缩略图</a></li>
					<li style="width: 99%" class="view"><label class="lable">质量管理体系证书</label><input
						type="text" value="JTGH2342345" /> <a href="javascript:void(0);"
						class="lnk-blue lnk-underline demo-image"
						image="${member.qms_img}"
						data-image="${b.imagePath}${member.qms_img}">查看缩略图</a></li> <#if
					(member.type.id==0)>
					<li style="width: 99%" class="view"><label class="lable">安全生产许可证</label><input
						name="safety_licenses_no" type="text" nullmsg="安全生产许可证不能为空"
						value="${member.safety_licenses_no}" /> <a
						href="javascript:void(0);"
						class="lnk-blue lnk-underline demo-image"
						image="${member.safety_licenses_img}"
						data-image="${b.imagePath}${member.safety_licenses_img}">查看缩略图</a>
					</li>
					<li style="width: 99%" class="view"><label class="lable">节能标识推广证</label><input
						name="energyNo" type="text" value="${member.getEnergyNo()}" /> <a
						href="javascript:void(0);"
						class="lnk-blue lnk-underline demo-image"
						image="${member.energyPath}"
						data-image="${b.imagePath}${member.energyPath}">查看缩略图</a></li> </#if>
					<#if (member.type.id==2)>
					<li style="width: 99%" class="view"><label class="lable">工业产品生产许可证</label><input
						name="production_license_no" type="text"
						value="${member.production_license_no}" /> <a
						href="javascript:void(0);"
						class="lnk-blue lnk-underline demo-image"
						image="${member.production_license_img}"
						data-image="${b.imagePath}${member.production_license_img}">查看缩略图</a>
					</li> </#if>
					<li style="width: 99%"><label class="lable">总交易额</label>${member.totalAmount}元</li>

					<li style="width: 99%"><label class="lable">扫描设备号</label>
					<textarea cols="" rows="3" class="textRfid" id="deviceNumber">${member.deviceNumber}</textarea></li>
					<li style="width: 99%"><label class="lable">邮政编码</label><input
						type="text" value="${member.code}" id="code" name="code" /></li>
					<li style="width: 99%"><label class="lable">审核状态</label><em
						class="state normal" id="checkState1">${member.checkState.getName()}</em></li>
					<li style="width: 99%"><label class="lable">帐户状态</label><em
						class="state verified" id="state1">${member.state.getName()}</em></li>
					<li style="width: 99%"><label class="lable">成立时间</label><input
						type="text"<#if
						(member.foundedDate??)>value="${member.foundedDate?string("yyyy-MM-dd")}"
						</#if> id="foundedDate" class="foundedDate" name="foundedDate" /></li>
					<li style="width: 99%"><label class="lable">市场专员</label><input
						type="text" value="${member.marketers}" id="marketers"
						name="marketers" /></li>

				</ul>
			</div>
			<div style="clear:both"></div>
          <div id="btnBox" class="btnBox" style="margin:auto"><@shiro.hasPermission name="28"><a href="#" class="button button-orange button-small" onclick="edit('${member.id}_info');return false;">确认修改</a></@shiro.hasPermission></div>
          </form>
          </div>
		<!-- 资质证书开始 -->
		<#if (member.type.id==0 || member.type.id==5 || member.type.id==6 || member.type.id==7)>
            <div class="infoBox" id="meb-news"> 		
		        <div id="block-name">资质证书</div>
                <div class="left-news">
                    <ul class="ly-clearFix">
                        <li style=" width:99%"><label class="lable">原有资质证书</label>${oldNum}个</li>
                    </ul>
                </div>
                <div class="right-news">
                    <ul class="ly-clearFix">
                       <li style=" width:99%"><label class="lable">现有资质证书</label>${num}个</li>
                    </ul>
                </div>
				<div>
			<ul class="ly-clearFix">
				<li style="width: 99%"><label class="lable">删除资质证书</label>${delNum}个</li>
				<li
					style="height:150px;width:843p;padding:0px">
					<div id="original2" class="slideui" style="height:130px;width:833px;padding:0px;margin-left:28px">
						<i class="buttonSildeLeft left" id="aleft"><img  src="${b.staticPath}images/icon/picSlideLeft.gif" /></i>
						<i class="buttonSildeRight right" id="aright"><img  src="${b.staticPath}images/icon/picSlideRight.gif" /></i>
						<div class="line-con">
							<ul class="imageList" id="imagelist_${member.id}">
								<#list ImageList as imageModel>
								<li style="width: 86px; height: 120px">
								<input type="hidden" name="image" value="${imageModel.image}" />
								<input type="hidden" name="memberNo" value="${imageModel.memberNo}" />
								<input type="hidden" name="certificateNo" value="${imageModel.certificateNo}" />
								<input type="hidden" name="remark" value="${imageModel.remark}" />
								<img
									src="${b.imagePath}${imageModel.image}" data="${b.imagePath}${imageModel.image}" />
								<tt></tt></li> </#list>
							</ul>
						</div>
					</div>
				</li>
				<li style="width: 99%"><label class="lable">新上传证书</label>10个 <input type="file" name="uploadify" id="uploadify_${member.id}" />
        <p>
            <a href="javascript:$('#uploadify_${member.id}').uploadify('upload')">上传</a>| 
        </p></li>
				<li
					style="height:150px;width:843p;padding:0px">
					<div id="original" class="slideui" style="height:130px;width:833px;padding:0px;margin-left:28px">
						<i class="buttonSildeLeft left" id="aleft"><img src="${b.staticPath}images/icon/picSlideLeft.gif" /></i>
						<i class="buttonSildeRight right" id="aright"><img  src="${b.staticPath}images/icon/picSlideRight.gif" /></i>
						<div class="line-con">
							<ul class="imageList">
								<#list newImagList as imageModel>
								<li style="width: 86px; height: 120px"><img
									src="${b.imagePath}${imageModel.image}" data="${b.imagePath}${imageModel.image}" />
								<tt></tt></li> </#list>
							</ul>
						</div>
					</div>


				</li>
			</ul>
		</div>
				<div id="btnBox" class="btnBox" style="margin:auto"><@shiro.hasPermission name="28"><a href="javascript:editImage('${member.id}')" class="button button-orange button-small">确认修改</a></@shiro.hasPermission></div>
			</div>
			</#if>
			<!-- 资质证书结束 -->
 		 <!-- 3C证书开始 -->
		<#if (member.type.id==1)>
            <div class="infoBox" id="meb-news"> 		
		        <div id="block-name">3C证书</div>
                <div class="left-news">
                    <ul class="ly-clearFix">
                        <li style=" width:99%"><label class="lable">原有3C证书</label>${oldNum}个</li>
                    </ul>
                </div>
                <div class="right-news">
                    <ul class="ly-clearFix">
                       <li style=" width:99%"><label class="lable">现有3C证书</label>${num}个</li>
                    </ul>
                </div>
				<div>
			<ul class="ly-clearFix">
				<li style="width: 99%"><label class="lable">删除3C证书</label>${delNum}个</li>
				<li
					style="height:150px;width:843p;padding:0px">
					<div id="SlideUl1" class="slideui" style="height:130px;width:833px;padding:0px;margin-left:28px">
						<i class="buttonSildeLeft left" id="aleft"><img  src="${b.staticPath}images/icon/picSlideLeft.gif" /></i>
						<i class="buttonSildeRight right" id="aright"><img src="${b.staticPath}images/icon/picSlideRight.gif" /></i>
						<div class="line-con">
							<ul class="imageList" id="cccimagelist_${member.id}">
								<#list ImageList as imageModel>
								<li style="width: 86px; height: 110px">
								<input type="hidden" name="image" value="${imageModel.image}" />
								<input type="hidden" name="memberNo" value="${imageModel.memberNo}" />
								<input type="hidden" name="certificateNo" value="${imageModel.certificateNo}" />
								<input type="hidden" name="remark" value="${imageModel.remark}" />
								<img
									src="${b.imagePath}${imageModel.image}" data="${b.imagePath}${imageModel.image}" />
								<tt></tt></li> </#list>
							</ul>
						</div>
					</div>
				</li>
				<li style="width: 99%"><label class="lable">新上传证书</label>10个 <a
					id="button-upload" href="javascript:fullImage();" class="normal">证书上传</a></li>
				<li
					style="height:150px;width:843p;padding:0px">
					<div id="SlideUl2" class="slideui" style="height:130px;width:833px;padding:0px;margin-left:28px">
						<i class="buttonSildeLeft left" id="aleft"><img src="${b.staticPath}images/icon/picSlideLeft.gif" /></i>
						<i class="buttonSildeRight right" id="aright"><img src="${b.staticPath}images/icon/picSlideRight.gif" /></i>
						<div class="line-con">
							<ul class="imageList">
								<#list newImagList as imageModel>
								<li style="width:80px;height:110px"><img
									src="${b.imagePath}${imageModel.image}" data="${b.imagePath}${imageModel.image}" />
								<tt></tt></li> </#list>
							</ul>
						</div>
					</div>


				</li>
			</ul>
		</div>
				<div id="btnBox" class="btnBox" style="margin:auto"><@shiro.hasPermission name="28"><a href="javascript:editImage('${member.id}')" class="button button-orange button-small">确认修改</a></@shiro.hasPermission></div>
			</div>
			</#if>
			<!-- 3C证书结束 -->
 		   <div class="infoBox" id="associated-enterprise"> 
		        <div id="block-name">关联企业</div>
		  	    <div id="relation">
				 <div>
		    	  <table style="background-color:#fff;" id="table_relevance">
			        <tr>
			         <th id="th" width="43%">企业名称</th>
			         <th id="th" width="12%">联系人</th>
			         <th id="th" width="15%">联系人电话</th>
			         <th id="th" width="10%">关联类型</th>
			         <th id="th" width="15%">备注</th>
		           	 <th id="th" width="5%"><a id="add-button" href="javascript:addrelevance('${member.id}');" title="新加一行"><img src="${b.staticPath}images/view/iviewer.zoom_in.gif" width="28" height="28" /></a></th>
			        </tr>
			        <#list relist as re>
			              <tr>
			                 <input type="hidden" value="${member.memberNo}" name="memberNo">
					         <td id="td"><input type="text" class="company" name="company" value="${re.company}" /></td>
				             <td id="td"><input type="text" name="linkman" value="${re.linkman}" /></td>
					         <td id="td"><input type="text" name="phone"  value="${re.phone}" /></td>
					         <td id="td"><select name="relevanceType" ><option value="2" <#if (re.relevanceType==2)> selected="selected" </#if> >型材厂</option><option value="6" <#if (re.relevanceType==6)> selected="selected" </#if> >代理商</option><option value="7" <#if (re.relevanceType==7)> selected="selected" </#if>>经销商</option><option value="10" <#if (re.relevanceType==10)> selected="selected" </#if>>同一出资方</option></select></td>
					         <td id="td"><input type="text" name="remark" value="${re.remark}" /></td>
				          	 <td id="td"><a id="Delete-button"   title="删除此行"><img src="${b.staticPath}images/view/iviewer.zoom_del.gif" width="20" height="20" /></a></td>
				          </tr>
			        </#list>
			      </table>
				 </div>
		        </div>			  
                <div id="btnBox" class="btnBox" style="margin:auto"><@shiro.hasPermission name="28"><a href="javascript:saverelevance('${member.id}')" class="button button-orange button-small">确认修改</a></@shiro.hasPermission></div>
            </div>
 		 <div id="btnBox" class="btnBox" style="margin:auto"><a href="#" class="button button-gray button-small">收起</a> </div>
 		 <div style="display: none;">
          <table id="tr_relevance">
               <tr >
                 <input type="hidden" value="${member.memberNo}" name="memberNo">
		         <td id="td"><input type="text" class="company" name="company"></td>
	             <td id="td"><input type="text" name="linkman"></td>
		         <td id="td"><input type="text" name="phone"></td>
		         <td id="td"><select name="relevanceType" ><option value="2">型材厂</option><option value="6">代理商</option><option value="7">经销商</option><option value="10">同一出资方</option></select></td>
		         <td id="td"><input type="text" name="remark"></td>
	          	 <td id="td"><a id="Delete-button"   title="删除此行"><img src="${b.staticPath}images/view/iviewer.zoom_del.gif" width="20" height="20" /></a></td>
	           </tr>
         </table>
        </div>
 </td>
 
